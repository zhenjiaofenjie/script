#make.contigs(file=GD.txt,insert=25,processors=12)
#screen.seqs(fasta=GD.trim.contigs.fasta,contigsreport=GD.contigs.report,maxambig=0,minlength=400,maxn=0,minoverlap=50,processors=12,group=GD.contigs.groups)
#unique.seqs(fasta=GD.trim.contigs.good.pcr.fasta)
#count.seqs(name=GD.trim.contigs.good.pcr.names,group=GD.contigs.good.pcr.groups)
#align.seqs(fasta=GD.trim.contigs.good.pcr.unique.fasta,reference=~/silva.bacteria/silva.bacteria.fasta,processors=12)
#summary.seqs(fasta=GD.trim.contigs.good.pcr.unique.align,count=GD.trim.contigs.good.pcr.count_table)
#choose the 2.5% end and the 97.5% start
#screen.seqs(fasta=GD.trim.contigs.good.pcr.unique.align,count=GD.trim.contigs.good.pcr.count_table,summary=GD.trim.contigs.good.pcr.unique.summary,start=6430,end=23439,maxhomop=8)
#summary.seqs(fasta=GD.trim.contigs.good.pcr.unique.good.align,count=GD.trim.contigs.good.pcr.good.count_table)
#filter.seqs(fasta=GD.trim.contigs.good.pcr.unique.good.align, vertical=T, trump=.)
#unique.seqs(fasta=GD.trim.contigs.good.pcr.unique.good.filter.abund.fasta,count=GD.trim.contigs.good.pcr.good.count_table)
set.current(processors=12)
split.abund(fasta=GD.trim.contigs.good.pcr.unique.good.filter.unique.fasta,count=GD.trim.contigs.good.pcr.unique.good.filter.count_table,cutoff=169)
pre.cluster(fasta=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.fasta,count=GD.trim.contigs.good.pcr.unique.good.filter.abund.count_table, diffs=5)
chimera.uchime(fasta=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.fasta, count=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.count_table, dereplicate=t)
remove.seqs(fasta=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.fasta, accnos=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.uchime.accnos)
classify.seqs(fasta=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.pick.fasta,count=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.uchime.pick.count_table,reference=~/trainset9_032012.pds.fasta,taxonomy=~/trainset9_032012.pds.tax,cutoff=80,processors=12)
remove.lineage(fasta=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.pick.fasta, count=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.uchime.pick.count_table, taxonomy=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.pick.pds.wang.taxonomy, taxon=Chloroplast-Mitochondria-unknown-Archaea-Eukaryota)
cluster.split(fasta=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.pick.pick.fasta, count=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.uchime.pick.pick.count_table, taxonomy=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.pick.pds.wang.pick.taxonomy, splitmethod=classify, taxlevel=4, cutoff=0.15)
#make.shared(list=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.pick.pick.an.unique_list.list, count=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.uchime.pick.pick.count_table, label=0.03)
#classify.otu(list=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.pick.pick.an.unique_list.list, count=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.uchime.pick.pick.count_table, taxonomy=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.pick.pds.wang.pick.taxonomy, label=0.03, cutoff=80)
#system(cp GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.pick.pick.an.unique_list.shared GD.an.shared)
#system(cp GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.pick.pick.an.unique_list.0.03.cons.taxonomy GD.an.cons.taxonomy)
#make.biom(shared=GD.an.shared, constaxonomy=GD.an.cons.taxonomy)
get.oturep(list=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.pick.pick.an.unique_list.list,count=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.uchime.pick.pick.count_table,label=0.03,fasta=GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.pick.pick.fasta,method=abundance)
system(sed -e '/^>/!s/-//g' -e '/^>/s/.*\(Otu[0-9]*\).*/>\1/' GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.pick.pick.an.unique_list.*.rep.fasta >GD.an.0.03.rep.sed.fasta)
system(cp GD.trim.contigs.good.pcr.unique.good.filter.unique.abund.precluster.pick.pick.an.unique_list.*.rep.fasta GD.an.0.03.rep.fasta)
