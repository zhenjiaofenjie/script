#make.contigs(file=mock.txt,insert=25,processors=12)
#screen.seqs(fasta=mock.trim.contigs.fasta,contigsreport=mock.contigs.report,maxambig=0,minlength=400,maxn=0,minoverlap=50,processors=12,group=mock.contigs.groups)
#unique.seqs(fasta=mock.trim.contigs.good.pcr.fasta)
#count.seqs(name=mock.trim.contigs.good.pcr.names,group=mock.contigs.good.pcr.groups)
#align.seqs(fasta=mock.trim.contigs.good.pcr.unique.fasta,reference=~/silva.bacteria/silva.bacteria.fasta,processors=12)
#summary.seqs(fasta=mock.trim.contigs.good.pcr.unique.align,count=mock.trim.contigs.good.pcr.count_table)
#choose the 2.5% end and the 97.5% start
set.current(processors=12)
screen.seqs(fasta=mock.trim.contigs.good.pcr.unique.align,count=mock.trim.contigs.good.pcr.count_table,summary=mock.trim.contigs.good.pcr.unique.summary,optimize=start-end,criteria=97.5,maxhomop=8,processors=12)
summary.seqs(fasta=mock.trim.contigs.good.pcr.unique.good.align,count=mock.trim.contigs.good.pcr.good.count_table)
filter.seqs(fasta=mock.trim.contigs.good.pcr.unique.good.align, vertical=T, trump=.)
unique.seqs(fasta=mock.trim.contigs.good.pcr.unique.good.filter.fasta,count=mock.trim.contigs.good.pcr.good.count_table)
#pre.cluster(fasta=mock.trim.contigs.good.pcr.unique.good.filter.unique.fasta,count=mock.trim.contigs.good.pcr.unique.good.filter.count_table, diffs=5)
chimera.uchime(fasta=mock.trim.contigs.good.pcr.unique.good.filter.unique.fasta, count=mock.trim.contigs.good.pcr.unique.good.filter.count_table, dereplicate=t)
remove.seqs(fasta=mock.trim.contigs.good.pcr.unique.good.filter.unique.fasta, accnos=mock.trim.contigs.good.pcr.unique.good.filter.unique.denovo.uchime.accnos)
classify.seqs(fasta=mock.trim.contigs.good.pcr.unique.good.filter.unique.pick.fasta,count=mock.trim.contigs.good.pcr.unique.good.filter.denovo.uchime.pick.count_table,reference=~/trainset9_032012.pds.fasta,taxonomy=~/trainset9_032012.pds.tax,cutoff=80)
remove.lineage(fasta=mock.trim.contigs.good.pcr.unique.good.filter.unique.pick.fasta, count=mock.trim.contigs.good.pcr.unique.good.filter.denovo.uchime.pick.count_table, taxonomy=mock.trim.contigs.good.pcr.unique.good.filter.unique.pick.pds.wang.taxonomy, taxon=Chloroplast-Mitochondria-unknown-Archaea-Eukaryota)
#specify how many seqs per sample
sub.sample(fasta=mock.trim.contigs.good.pcr.unique.good.filter.unique.pick.pick.fasta,count=mock.trim.contigs.good.pcr.unique.good.filter.denovo.uchime.pick.pick.count_table,size=10000,persample=T)
system(cp mock.trim.contigs.good.pcr.unique.good.filter.unique.pick.pick.subsample.fasta filtered.fasta)
system(cp mock.trim.contigs.good.pcr.unique.good.filter.denovo.uchime.pick.pick.subsample.count_table filtered.count_table)
system(resize_moira_filtered.pl filtered.fasta filtered.count_table)
#dist.seqs(fasta=filtered.resize.fasta,cutoff=0.03)
